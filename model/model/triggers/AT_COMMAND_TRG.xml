<?xml version="1.0"?>
  <database name="TRIGGER AT_COMMAND_TRG">
    <trigger name="AT_COMMAND_TRG" table="AT_COMMAND" fires="after" insert="true" update="true" delete="false" foreach="row">
      <body><![CDATA[




/*************************************************************************
* The contents of this file are subject to the Openbravo  Public  License
* Version  1.0  (the  "License"),  being   the  Mozilla   Public  License
* Version 1.1  with a permitted attribution clause; you may not  use this
* file except in compliance with the License. You  may  obtain  a copy of
* the License at http://www.openbravo.com/legal/license.html
* Software distributed under the License  is  distributed  on  an "AS IS"
* basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
* License for the specific  language  governing  rights  and  limitations
* under the License.
* The Original Code is Openbravo ERP.
* The Initial Developer of the Original Code is Openbravo SL
* All portions are Copyright (C) 2001-2006 Openbravo SL
* All Rights Reserved.
* Contributor(s):  ______________________________________.
************************************************************************/
        
BEGIN
    
    IF AD_isTriggerEnabled()='N' THEN RETURN;
    END IF;


    -- Insert AT_Command Trigger
    --  for Translation
    IF INSERTING
    THEN
    --  Create Translation Row
  INSERT
  INTO AT_Command_Trl
    (
      AT_Command_Trl_ID, AT_Command_ID, AD_LANGUAGE, AD_Client_ID,
      AD_Org_ID, IsActive, Created,
      CreatedBy, Updated, UpdatedBy,
      Name, Description, ArgHelp1,
      ArgHelp2, ArgHelp3, IsTranslated
    )
  SELECT get_uuid(), :NEW.AT_Command_ID,
    AD_LANGUAGE, :NEW.AD_Client_ID, :NEW.AD_Org_ID,
    :NEW.IsActive, :NEW.Created, :NEW.CreatedBy,
    :NEW.Updated, :NEW.UpdatedBy, :NEW.Name,
    :NEW.Description, :NEW.ArgHelp1, :NEW.ArgHelp2,
    :NEW.ArgHelp3,  'N'
  FROM AD_LANGUAGE
  WHERE IsActive='Y'
    AND IsSystemLanguage='Y';
 END IF;
 -- Inserting
 -- AT_Command update trigger
 --  synchronize name,...
 IF UPDATING THEN
  IF(COALESCE(:old.Name, '.') <> COALESCE(:NEW.Name, '.')
  OR COALESCE(:old.Description, '.') <> COALESCE(:NEW.Description, '.')
  OR COALESCE(:old.ArgHelp1, 0) <> COALESCE(:NEW.ArgHelp1, 0)
  OR COALESCE(:old.ArgHelp2, 0) <> COALESCE(:NEW.ArgHelp2, 0)
  OR COALESCE(:old.ArgHelp3, 0) <> COALESCE(:NEW.ArgHelp3, 0))
 THEN
    UPDATE AT_Command_Trl
      SET IsTranslated='N',
      Updated=now()
    WHERE AT_Command_ID=:NEW.AT_Command_ID;
  END IF;
 END IF;
-- Updating
END AT_COMMAND_TRG
]]></body>
    </trigger>
  </database>
